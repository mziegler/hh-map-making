<html>
<head>

    <title>Swallow-tail butterfly map</title>

    <!-- Leaflet web map library   http://leafletjs.com/ -->
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    
    <!-- Weirdly-named CSV parsing libary -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.1.2/papaparse.min.js"></script>
   
            
</head>
<body>

    <!-- map container -->
    <div id="map_id" style="width:100%; height:100%;"></div>

    <script type="text/javascript">
        
        
        
        // Initialize the map
        // TODO #1 : Initialize the map!
        


        // TODO #2  Set the view of the map to show India.



        // OpenStreetMap   http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png
        // OpenTopoMap     http://c.tile.opentopomap.org/{z}/{x}/{y}.png
        // OSM Stamen Watercolor  http://d.tile.stamen.com/watercolor/{z}/{x}/{y}.jpg
        // More base maps here:   http://mc.bbbike.org/mc/
        
        // TODO #3  Add a tile layer for a base map.
      
        
        
        
        
        // Create a new layer group to hold the markers.
        var markerLayer = L.layerGroup().addTo(map);
        
        
        // This function is called when the CSV file finishes loading.
        function addMarkerData(data) {
            
            // Loop over CSV rows.
            for (var i = 0; i < data.length; i++) {
                var row = data[i];
                var imageURL = row['image file'] ? row['image file'].split(', ')[0] : null;
                                                
                                                
                                                
                // TODO #4                             
                // Add a marker to the map with the coordinates from the data point.
                
                
                
                // TODO #5
                // If there is an image for this data point, create a popup on this marker.
                // '<img src="' + imageURL + '" style="width:200px;height:auto">'

            }    
        }
        
        
        
        
        
        // Load and parse the CSV file.
        Papa.parse('india-biodiversity-data/swallowtail-butterflies.csv', {
            download: true,
            header: true,
            dynamicTyping: true,
            
            // This function is called when the CSV file loads completely
            complete: function(results) {
                addMarkerData(results.data);
            },
        });
        

       
        
        
    </script>


</body>
</html>
